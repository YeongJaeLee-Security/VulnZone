<%@page import="ExploitsUtil.DomXss"%>
<%@page import="ExploitsParam.DomXssParams"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="../common/commonLevel.jsp" %>

<!DOCTYPE html>
<html>
<head>
<jsp:include page="../common/commonHead.jsp" />
</head>
<body>
	<jsp:include page="../common/commonHeader.jsp" />
	<%@ include file="../common/commonExploitsNavigation.jsp" %>
	
	<div class="container">
		<h2>DOM Based Cross Site Scripting (XSS): <em style="color: red;"><%= currentLevel %></em></h2>
		<div class="col-sm-6 col-md-6">
			<div class="jumbotron" style="padding-top: 20px;">
				<form>
                
                <p class="text-muted">Please choose a language</p>
                
                <div class="form-group">
                    <select name="default" class="form-control">
                        <script>
                        	if (document.location.href.indexOf("default") >= 0) {
                        		var lang = document.location.href.substring(document.location.href.indexOf("default=") + 8);
                        		document.write("<option value='" + lang + "'>" + decodeURI(lang) + "</option>");
                        		document.write("<option value='' disabled='disabled'>----</option>");
                        	}
                        	
                        	document.write("<option value='English'>English</option>");
                        	document.write("<option value='French'>French</option>");
                        	document.write("<option value='Spanish'>Spanish</option>");
                        	document.write("<option value='German'>German</option>");
                        </script>
                    </select>
                </div>
                
                <input type="submit" class="btn btn-primary form-control" value="Select">
                
                <%
                if (request.getParameter("default") != null) {
                	DomXssParams domXssParams = new DomXssParams(request);
                	DomXss domXss = new DomXss();
                	
                	String result = currentLevel.equalsIgnoreCase("easy") ? domXss.easy(domXssParams)
							: domXss.hard(domXssParams);
                	
                	if (result != null && result.length() > 0) {
						response.sendRedirect(result);
						
						return;
					}
                }
                %>
            </form>
			</div>
		</div>
	</div>
	
	<%@ include file="../common/commonFooter.jsp" %>
</body>
</html>