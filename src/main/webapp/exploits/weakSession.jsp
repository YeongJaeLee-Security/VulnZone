<%@page import="ExploitsUtil.WeakSession"%>
<%@page import="ExploitsParam.WeakSessionParams"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="../common/commonLevel.jsp" %>

<!DOCTYPE html>
<html>
<head>
<jsp:include page="../common/commonHead.jsp" />
</head>
<body>
	<jsp:include page="../common/commonHeader.jsp" />
	<%@ include file="../common/commonExploitsNavigation.jsp" %>
	
	<div class="container">
		<h2>Weak Session IDs: <em style="color: red;"><%= currentLevel %></em></h2>
		<p><em>This page will set a new cookie called VulnZoneSession each time the button is clicked.</em></p>
		
		<div class="col-sm-6 col-md-6">
			<div class="jumbotron" style="padding-top: 20px;">
				<p style="margin-top: 20px; text-align: center;">Generate a session ID</p>
				<form method="POST">
					<input type="submit" class="btn btn-primary form-control" name="Generate" value="Generate" style="margin-top: 10px;">
				</form>
				
				<%
				if (request.getParameter("Generate") != null) {
					WeakSessionParams weakSessionParams = new WeakSessionParams(request, response);
					WeakSession weakSession = new WeakSession();
					
					if (currentLevel.equalsIgnoreCase("easy")) {
						weakSession.easy(weakSessionParams);
					} else {
						weakSession.hard(weakSessionParams);
					}
				}
				%>
			</div>
		</div>
	</div>
	
	<%@ include file="../common/commonFooter.jsp" %>
</body>
</html>