<%@page import="ExploitsUtil.ReflectedXss"%>
<%@page import="ExploitsParam.ReflectedXssParams"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="../common/commonLevel.jsp" %>

<!DOCTYPE html>
<html>
<head>
<jsp:include page="../common/commonHead.jsp" />
</head>
<body>
	<jsp:include page="../common/commonHeader.jsp" />
	<%@ include file="../common/commonExploitsNavigation.jsp" %>
	
	<div class="container">
		<h2>Reflected Cross Site Scripting (XSS): <em style="color: red;"><%= currentLevel %></em></h2>
		
		<div class="col-sm-6 col-md-6">
			<div class="jumbotron" style="padding-top: 20px;">
				<form method="GET" action="#" name="XSS">
					<div class="form-group" style="margin-top: 30px;">
						<input type="text" class="form-control" placeholder="What's your name?" size="15" name="name">
					</div>

					<input type="submit" class="btn btn-primary form-control"
						name="Submit" value="Submit">

					<div style="margin-top: 20px;">
						<%
						if (request.getParameter("Submit") != null && request.getParameter("name") != null) {
							ReflectedXssParams reflectedXssParams = new ReflectedXssParams(request, response);
							ReflectedXss reflectedXss = new ReflectedXss();
							
							String result = currentLevel.equalsIgnoreCase("easy") ? reflectedXss.easy(reflectedXssParams) : reflectedXss.hard(reflectedXssParams);
							
							if (result != null) {
								out.println("<pre style='color: red;'>" + result + "</pre>");
							}
						}
						%>
					</div>
				</form>
			</div>
		</div>
	</div>
	
	<%@ include file="../common/commonFooter.jsp" %>
</body>
</html>