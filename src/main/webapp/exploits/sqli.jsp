<%@page import="ExploitsUtil.SQLInjection"%>
<%@page import="ExploitsParam.SQLInjectionParams"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="../common/commonLevel.jsp" %>
<%
SQLInjection sqlInjection = new SQLInjection();
%>

<!DOCTYPE html>
<html>
<head>
<jsp:include page="../common/commonHead.jsp" />
</head>
<body>
	<jsp:include page="../common/commonHeader.jsp" />
	<%@ include file="../common/commonExploitsNavigation.jsp" %>
	
	<div class="container">
		<h2>SQL Injection: <em style="color: red;"><%= currentLevel %></em></h2>
		
		<div class="col-sm-6 col-md-6">
			<div class="jumbotron" style="padding-top: 20px;">
				<h3 style="text-align: center;">SQL Injection<br style="margin-top: 20px;"/>Select an User's id number</h3>
				<form method=<%= currentLevel.equalsIgnoreCase("easy") ? "GET" : "POST" %> action="#">
					<div class="form-group" style="margin-top: 30px;">
						<% if (currentLevel.equalsIgnoreCase("easy")) {  %>
						<input type="text" class="form-control" placeholder="Enter an User's id number..." size="15" name="id">
						<% } else { %>
							<select name="id" class="form-control">
								<%									
									int userCount = sqlInjection.userCount();
									for (int i=0; i < userCount; i++) {
								%>
									<option value="<%= i + 1 %>"><%= i + 1 %></option>
								<%
									}
								%>
                    		</select>
						<%
						}
						%>
					</div>

					<!-- Submit 버튼 -->
					<input type="submit" class="btn btn-primary form-control"
						name="Submit" value="Submit">

					<div style="margin-top: 20px;">
						<%
						if (request.getParameter("Submit") != null && request.getParameter("id") != null) {							
							SQLInjectionParams sqlInjectionParams = new SQLInjectionParams(request);
							
							String result = currentLevel.equalsIgnoreCase("easy") ? sqlInjection.low(sqlInjectionParams)
							: sqlInjection.hard(sqlInjectionParams);

							if (result != null && result.length() > 0) {
								out.println("<pre style='color: red;'>" + result + "</pre>");
							}
						}
						%>
					</div>
				</form>
			</div>
		</div>
	</div>
	
	<%@ include file="../common/commonFooter.jsp" %>
</body>
</html>